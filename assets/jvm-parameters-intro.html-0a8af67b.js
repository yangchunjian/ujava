import{_ as r}from"./plugin-vue_export-helper-c27b6911.js";import{r as i,o,c as l,a as e,b as a,d as s,e as t}from"./app-8a5cd404.js";const c="/assets/å†…å­˜åŒºåŸŸå¸¸è§é…ç½®å‚æ•°-53ddeca6.png",p={},d={href:"https://www.baeldung.com/jvm-parameters",target:"_blank",rel:"noopener noreferrer"},u=e("p",null,"JDK ç‰ˆæœ¬ï¼š1.8",-1),m=t('<h2 id="_1-æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#_1-æ¦‚è¿°" aria-hidden="true">#</a> 1.æ¦‚è¿°</h2><p>åœ¨æœ¬ç¯‡æ–‡ç« ä¸­ï¼Œä½ å°†æŒæ¡æœ€å¸¸ç”¨çš„ JVM å‚æ•°é…ç½®ã€‚</p><h2 id="_2-å †å†…å­˜ç›¸å…³" tabindex="-1"><a class="header-anchor" href="#_2-å †å†…å­˜ç›¸å…³" aria-hidden="true">#</a> 2.å †å†…å­˜ç›¸å…³</h2><blockquote><p>Java è™šæ‹Ÿæœºæ‰€ç®¡ç†çš„å†…å­˜ä¸­æœ€å¤§çš„ä¸€å—ï¼ŒJava å †æ˜¯æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ä¸€å—å†…å­˜åŒºåŸŸï¼Œåœ¨è™šæ‹Ÿæœºå¯åŠ¨æ—¶åˆ›å»ºã€‚<strong>æ­¤å†…å­˜åŒºåŸŸçš„å”¯ä¸€ç›®çš„å°±æ˜¯å­˜æ”¾å¯¹è±¡å®ä¾‹ï¼Œå‡ ä¹æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹ä»¥åŠæ•°ç»„éƒ½åœ¨è¿™é‡Œåˆ†é…å†…å­˜ã€‚</strong></p></blockquote><figure><img src="'+c+`" alt="å†…å­˜åŒºåŸŸå¸¸è§é…ç½®å‚æ•°" tabindex="0" loading="lazy"><figcaption>å†…å­˜åŒºåŸŸå¸¸è§é…ç½®å‚æ•°</figcaption></figure><h3 id="_2-1-æ˜¾å¼æŒ‡å®šå †å†…å­˜â€“xmså’Œ-xmx" tabindex="-1"><a class="header-anchor" href="#_2-1-æ˜¾å¼æŒ‡å®šå †å†…å­˜â€“xmså’Œ-xmx" aria-hidden="true">#</a> 2.1.æ˜¾å¼æŒ‡å®šå †å†…å­˜<code>â€“Xms</code>å’Œ<code>-Xmx</code></h3><p>ä¸æ€§èƒ½æœ‰å…³çš„æœ€å¸¸è§å®è·µä¹‹ä¸€æ˜¯æ ¹æ®åº”ç”¨ç¨‹åºè¦æ±‚åˆå§‹åŒ–å †å†…å­˜ã€‚å¦‚æœæˆ‘ä»¬éœ€è¦æŒ‡å®šæœ€å°å’Œæœ€å¤§å †å¤§å°ï¼ˆæ¨èæ˜¾ç¤ºæŒ‡å®šå¤§å°ï¼‰ï¼Œä»¥ä¸‹å‚æ•°å¯ä»¥å¸®åŠ©ä½ å®ç°ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>-Xms<span class="token operator">&lt;</span>heap size<span class="token operator">&gt;</span><span class="token punctuation">[</span>unit<span class="token punctuation">]</span>
-Xmx<span class="token operator">&lt;</span>heap size<span class="token operator">&gt;</span><span class="token punctuation">[</span>unit<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>heap size</strong> è¡¨ç¤ºè¦åˆå§‹åŒ–å†…å­˜çš„å…·ä½“å¤§å°ã€‚</li><li><strong>unit</strong> è¡¨ç¤ºè¦åˆå§‹åŒ–å†…å­˜çš„å•ä½ã€‚å•ä½ä¸º <strong><em>â€œ gâ€</em></strong> (GB)ã€<strong><em>â€œ mâ€</em></strong>ï¼ˆMBï¼‰ã€<strong><em>â€œ kâ€</em></strong>ï¼ˆKBï¼‰ã€‚</li></ul><p>ä¸¾ä¸ªæ —å­ ğŸŒ°ï¼Œå¦‚æœæˆ‘ä»¬è¦ä¸º JVM åˆ†é…æœ€å° 2 GB å’Œæœ€å¤§ 5 GB çš„å †å†…å­˜å¤§å°ï¼Œæˆ‘ä»¬çš„å‚æ•°åº”è¯¥è¿™æ ·æ¥å†™ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token parameter variable">-Xms2G</span> <span class="token parameter variable">-Xmx5G</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_2-2-æ˜¾å¼æ–°ç”Ÿä»£å†…å­˜-young-generation" tabindex="-1"><a class="header-anchor" href="#_2-2-æ˜¾å¼æ–°ç”Ÿä»£å†…å­˜-young-generation" aria-hidden="true">#</a> 2.2.æ˜¾å¼æ–°ç”Ÿä»£å†…å­˜(Young Generation)</h3>`,12),v={href:"https://docs.oracle.com/javase/8/docs/technotes/guides/vm/gctuning/sizing.html",target:"_blank",rel:"noopener noreferrer"},h=e("code",null,"Young Generation",-1),b=e("em",null,"MB",-1),g=e("em",null,"æ— é™åˆ¶",-1),_=t(`<p>ä¸€å…±æœ‰ä¸¤ç§æŒ‡å®š æ–°ç”Ÿä»£å†…å­˜(Young Generation)å¤§å°çš„æ–¹æ³•ï¼š</p><p><strong>1.é€šè¿‡<code>-XX:NewSize</code>å’Œ<code>-XX:MaxNewSize</code>æŒ‡å®š</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token parameter variable">-XX:NewSize</span><span class="token operator">=</span><span class="token operator">&lt;</span>young size<span class="token operator">&gt;</span><span class="token punctuation">[</span>unit<span class="token punctuation">]</span>
<span class="token parameter variable">-XX:MaxNewSize</span><span class="token operator">=</span><span class="token operator">&lt;</span>young size<span class="token operator">&gt;</span><span class="token punctuation">[</span>unit<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸¾ä¸ªæ —å­ ğŸŒ°ï¼Œå¦‚æœæˆ‘ä»¬è¦ä¸º æ–°ç”Ÿä»£åˆ†é… æœ€å° 256m çš„å†…å­˜ï¼Œæœ€å¤§ 1024m çš„å†…å­˜æˆ‘ä»¬çš„å‚æ•°åº”è¯¥è¿™æ ·æ¥å†™ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token parameter variable">-XX:NewSize</span><span class="token operator">=</span>256m
<span class="token parameter variable">-XX:MaxNewSize</span><span class="token operator">=</span>1024m
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>2.é€šè¿‡<code>-Xmn&lt;young size&gt;[unit]</code>æŒ‡å®š</strong></p><p>ä¸¾ä¸ªæ —å­ ğŸŒ°ï¼Œå¦‚æœæˆ‘ä»¬è¦ä¸º æ–°ç”Ÿä»£åˆ†é… 256m çš„å†…å­˜ï¼ˆNewSize ä¸ MaxNewSize è®¾ä¸ºä¸€è‡´ï¼‰ï¼Œæˆ‘ä»¬çš„å‚æ•°åº”è¯¥è¿™æ ·æ¥å†™ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token parameter variable">-Xmn256m</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>GC è°ƒä¼˜ç­–ç•¥ä¸­å¾ˆé‡è¦çš„ä¸€æ¡ç»éªŒæ€»ç»“æ˜¯è¿™æ ·è¯´çš„ï¼š</p><blockquote><p>å°†æ–°å¯¹è±¡é¢„ç•™åœ¨æ–°ç”Ÿä»£ï¼Œç”±äº Full GC çš„æˆæœ¬è¿œé«˜äº Minor GCï¼Œå› æ­¤å°½å¯èƒ½å°†å¯¹è±¡åˆ†é…åœ¨æ–°ç”Ÿä»£æ˜¯æ˜æ™ºçš„åšæ³•ï¼Œå®é™…é¡¹ç›®ä¸­æ ¹æ® GC æ—¥å¿—åˆ†ææ–°ç”Ÿä»£ç©ºé—´å¤§å°åˆ†é…æ˜¯å¦åˆç†ï¼Œé€‚å½“é€šè¿‡â€œ-Xmnâ€å‘½ä»¤è°ƒèŠ‚æ–°ç”Ÿä»£å¤§å°ï¼Œæœ€å¤§é™åº¦é™ä½æ–°å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£çš„æƒ…å†µã€‚</p></blockquote><p>å¦å¤–ï¼Œä½ è¿˜å¯ä»¥é€šè¿‡ <strong><code>-XX:NewRatio=&lt;int&gt;</code></strong> æ¥è®¾ç½®è€å¹´ä»£ä¸æ–°ç”Ÿä»£å†…å­˜çš„æ¯”å€¼ã€‚</p><p>æ¯”å¦‚ä¸‹é¢çš„å‚æ•°å°±æ˜¯è®¾ç½®è€å¹´ä»£ä¸æ–°ç”Ÿä»£å†…å­˜çš„æ¯”å€¼ä¸º 1ã€‚ä¹Ÿå°±æ˜¯è¯´è€å¹´ä»£å’Œæ–°ç”Ÿä»£æ‰€å æ¯”å€¼ä¸º 1ï¼š1ï¼Œæ–°ç”Ÿä»£å æ•´ä¸ªå †æ ˆçš„ 1/2ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>-XX:NewRatio=1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_2-3-æ˜¾å¼æŒ‡å®šæ°¸ä¹…ä»£-å…ƒç©ºé—´çš„å¤§å°" tabindex="-1"><a class="header-anchor" href="#_2-3-æ˜¾å¼æŒ‡å®šæ°¸ä¹…ä»£-å…ƒç©ºé—´çš„å¤§å°" aria-hidden="true">#</a> 2.3.æ˜¾å¼æŒ‡å®šæ°¸ä¹…ä»£/å…ƒç©ºé—´çš„å¤§å°</h3><p><strong>ä» Java 8 å¼€å§‹ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰æŒ‡å®š Metaspace çš„å¤§å°ï¼Œéšç€æ›´å¤šç±»çš„åˆ›å»ºï¼Œè™šæ‹Ÿæœºä¼šè€—å°½æ‰€æœ‰å¯ç”¨çš„ç³»ç»Ÿå†…å­˜ï¼ˆæ°¸ä¹…ä»£å¹¶ä¸ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼‰ã€‚</strong></p><p>JDK 1.8 ä¹‹å‰æ°¸ä¹…ä»£è¿˜æ²¡è¢«å½»åº•ç§»é™¤çš„æ—¶å€™é€šå¸¸é€šè¿‡ä¸‹é¢è¿™äº›å‚æ•°æ¥è°ƒèŠ‚æ–¹æ³•åŒºå¤§å°</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token parameter variable">-XX:PermSize</span><span class="token operator">=</span>N <span class="token comment">#æ–¹æ³•åŒº (æ°¸ä¹…ä»£) åˆå§‹å¤§å°</span>
<span class="token parameter variable">-XX:MaxPermSize</span><span class="token operator">=</span>N <span class="token comment">#æ–¹æ³•åŒº (æ°¸ä¹…ä»£) æœ€å¤§å¤§å°,è¶…è¿‡è¿™ä¸ªå€¼å°†ä¼šæŠ›å‡º OutOfMemoryError å¼‚å¸¸:java.lang.OutOfMemoryError: PermGen</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ç›¸å¯¹è€Œè¨€ï¼Œåƒåœ¾æ”¶é›†è¡Œä¸ºåœ¨è¿™ä¸ªåŒºåŸŸæ˜¯æ¯”è¾ƒå°‘å‡ºç°çš„ï¼Œä½†å¹¶éæ•°æ®è¿›å…¥æ–¹æ³•åŒºåå°±â€œæ°¸ä¹…å­˜åœ¨â€äº†ã€‚</p><p><strong>JDK 1.8 çš„æ—¶å€™ï¼Œæ–¹æ³•åŒºï¼ˆHotSpot çš„æ°¸ä¹…ä»£ï¼‰è¢«å½»åº•ç§»é™¤äº†ï¼ˆJDK1.7 å°±å·²ç»å¼€å§‹äº†ï¼‰ï¼Œå–è€Œä»£ä¹‹æ˜¯å…ƒç©ºé—´ï¼Œå…ƒç©ºé—´ä½¿ç”¨çš„æ˜¯æœ¬åœ°å†…å­˜ã€‚</strong></p><p>ä¸‹é¢æ˜¯ä¸€äº›å¸¸ç”¨å‚æ•°ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token parameter variable">-XX:MetaspaceSize</span><span class="token operator">=</span>N <span class="token comment">#è®¾ç½® Metaspace çš„åˆå§‹å¤§å°ï¼ˆæ˜¯ä¸€ä¸ªå¸¸è§çš„è¯¯åŒºï¼Œåé¢ä¼šè§£é‡Šï¼‰</span>
<span class="token parameter variable">-XX:MaxMetaspaceSize</span><span class="token operator">=</span>N <span class="token comment">#è®¾ç½® Metaspace çš„æœ€å¤§å¤§å°</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>`,21),k={href:"https://github.com/Snailclimb/JavaGuide/issues/1947",target:"_blank",rel:"noopener noreferrer"},X=e("p",null,[a("1ã€Metaspace çš„åˆå§‹å®¹é‡å¹¶ä¸æ˜¯ "),e("code",null,"-XX:MetaspaceSize"),a(" è®¾ç½®ï¼Œæ— è®º "),e("code",null,"-XX:MetaspaceSize"),a(" é…ç½®ä»€ä¹ˆå€¼ï¼Œå¯¹äº 64 ä½ JVM æ¥è¯´ï¼ŒMetaspace çš„åˆå§‹å®¹é‡éƒ½æ˜¯ 21807104ï¼ˆçº¦ 20.8mï¼‰ã€‚")],-1),f={href:"https://docs.oracle.com/javase/8/docs/technotes/guides/vm/gctuning/considerations.html",target:"_blank",rel:"noopener noreferrer"},M=e("blockquote",null,[e("p",null,"Specify a higher value for the option MetaspaceSize to avoid early garbage collections induced for class metadata. The amount of class metadata allocated for an application is application-dependent and general guidelines do not exist for the selection of MetaspaceSize. The default size of MetaspaceSize is platform-dependent and ranges from 12 MB to about 20 MB."),e("p",null,"MetaspaceSize çš„é»˜è®¤å¤§å°å–å†³äºå¹³å°ï¼ŒèŒƒå›´ä» 12 MB åˆ°å¤§çº¦ 20 MBã€‚")],-1),x={href:"https://mp.weixin.qq.com/s/jqfppqqd98DfAJHZhFbmxA",target:"_blank",rel:"noopener noreferrer"},G=t(`<p>2ã€Metaspace ç”±äºä½¿ç”¨ä¸æ–­æ‰©å®¹åˆ°<code>-XX:MetaspaceSize</code>å‚æ•°æŒ‡å®šçš„é‡ï¼Œå°±ä¼šå‘ç”Ÿ FGCï¼Œä¸”ä¹‹åæ¯æ¬¡ Metaspace æ‰©å®¹éƒ½ä¼šå‘ç”Ÿ Full GCã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼ŒMetaspaceSize è¡¨ç¤º Metaspace ä½¿ç”¨è¿‡ç¨‹ä¸­è§¦å‘ Full GC çš„é˜ˆå€¼ï¼Œåªå¯¹è§¦å‘èµ·ä½œç”¨ã€‚</p><p>åƒåœ¾æœé›†å™¨å†…éƒ¨æ˜¯æ ¹æ®å˜é‡ <code>_capacity_until_GC</code>æ¥åˆ¤æ–­ Metaspace åŒºåŸŸæ˜¯å¦è¾¾åˆ°é˜ˆå€¼çš„ï¼Œåˆå§‹åŒ–ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">void</span> MetaspaceGC<span class="token operator">::</span><span class="token function">initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Set the high-water mark to MaxMetapaceSize during VM initializaton since</span>
  <span class="token comment">// we can&#39;t do a GC during initialization.</span>
  _capacity_until_GC <span class="token operator">=</span> MaxMetaspaceSize<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4),S={href:"https://github.com/Snailclimb/JavaGuide/issues/1204",target:"_blank",rel:"noopener noreferrer"},C=e("h2",{id:"_3-åƒåœ¾æ”¶é›†ç›¸å…³",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#_3-åƒåœ¾æ”¶é›†ç›¸å…³","aria-hidden":"true"},"#"),a(" 3.åƒåœ¾æ”¶é›†ç›¸å…³")],-1),z=e("h3",{id:"_3-1-åƒåœ¾å›æ”¶å™¨",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#_3-1-åƒåœ¾å›æ”¶å™¨","aria-hidden":"true"},"#"),a(" 3.1.åƒåœ¾å›æ”¶å™¨")],-1),J={href:"http://www.oracle.com/webfolder/technetwork/tutorials/obe/java/gc01/index.html",target:"_blank",rel:"noopener noreferrer"},O=t(`<p>JVM å…·æœ‰å››ç§ç±»å‹çš„ GC å®ç°ï¼š</p><ul><li>ä¸²è¡Œåƒåœ¾æ”¶é›†å™¨</li><li>å¹¶è¡Œåƒåœ¾æ”¶é›†å™¨</li><li>CMS åƒåœ¾æ”¶é›†å™¨</li><li>G1 åƒåœ¾æ”¶é›†å™¨</li></ul><p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‚æ•°å£°æ˜è¿™äº›å®ç°ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token parameter variable">-XX:+UseSerialGC</span>
<span class="token parameter variable">-XX:+UseParallelGC</span>
<span class="token parameter variable">-XX:+UseParNewGC</span>
<span class="token parameter variable">-XX:+UseG1GC</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4),w=e("em",null,"åƒåœ¾å›æ”¶",-1),y={href:"https://github.com/Snailclimb/JavaGuide/blob/master/docs/java/jvm/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6.md",target:"_blank",rel:"noopener noreferrer"},V=t(`<h3 id="_3-2-gc-æ—¥å¿—è®°å½•" tabindex="-1"><a class="header-anchor" href="#_3-2-gc-æ—¥å¿—è®°å½•" aria-hidden="true">#</a> 3.2.GC æ—¥å¿—è®°å½•</h3><p>ç”Ÿäº§ç¯å¢ƒä¸Šï¼Œæˆ–è€…å…¶ä»–è¦æµ‹è¯• GC é—®é¢˜çš„ç¯å¢ƒä¸Šï¼Œä¸€å®šä¼šé…ç½®ä¸Šæ‰“å° GC æ—¥å¿—çš„å‚æ•°ï¼Œä¾¿äºåˆ†æ GC ç›¸å…³çš„é—®é¢˜ã€‚</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># å¿…é€‰</span>
<span class="token comment"># æ‰“å°åŸºæœ¬ GC ä¿¡æ¯</span>
<span class="token parameter variable">-XX:+PrintGCDetails</span>
<span class="token parameter variable">-XX:+PrintGCDateStamps</span>
<span class="token comment"># æ‰“å°å¯¹è±¡åˆ†å¸ƒ</span>
<span class="token parameter variable">-XX:+PrintTenuringDistribution</span>
<span class="token comment"># æ‰“å°å †æ•°æ®</span>
<span class="token parameter variable">-XX:+PrintHeapAtGC</span>
<span class="token comment"># æ‰“å°Referenceå¤„ç†ä¿¡æ¯</span>
<span class="token comment"># å¼ºå¼•ç”¨/å¼±å¼•ç”¨/è½¯å¼•ç”¨/è™šå¼•ç”¨/finalize ç›¸å…³çš„æ–¹æ³•</span>
<span class="token parameter variable">-XX:+PrintReferenceGC</span>
<span class="token comment"># æ‰“å°STWæ—¶é—´</span>
<span class="token parameter variable">-XX:+PrintGCApplicationStoppedTime</span>

<span class="token comment"># å¯é€‰</span>
<span class="token comment"># æ‰“å°safepointä¿¡æ¯ï¼Œè¿›å…¥ STW é˜¶æ®µä¹‹å‰ï¼Œéœ€è¦è¦æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„ safepoint</span>
<span class="token parameter variable">-XX:+PrintSafepointStatistics</span>
<span class="token parameter variable">-XX:PrintSafepointStatisticsCount</span><span class="token operator">=</span><span class="token number">1</span>

<span class="token comment"># GCæ—¥å¿—è¾“å‡ºçš„æ–‡ä»¶è·¯å¾„</span>
-Xloggc:/path/to/gc-%t.log
<span class="token comment"># å¼€å¯æ—¥å¿—æ–‡ä»¶åˆ†å‰²</span>
<span class="token parameter variable">-XX:+UseGCLogFileRotation</span>
<span class="token comment"># æœ€å¤šåˆ†å‰²å‡ ä¸ªæ–‡ä»¶ï¼Œè¶…è¿‡ä¹‹åä»å¤´æ–‡ä»¶å¼€å§‹å†™</span>
<span class="token parameter variable">-XX:NumberOfGCLogFiles</span><span class="token operator">=</span><span class="token number">14</span>
<span class="token comment"># æ¯ä¸ªæ–‡ä»¶ä¸Šé™å¤§å°ï¼Œè¶…è¿‡å°±è§¦å‘åˆ†å‰²</span>
<span class="token parameter variable">-XX:GCLogFileSize</span><span class="token operator">=</span>50M
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-å¤„ç†-oom" tabindex="-1"><a class="header-anchor" href="#_4-å¤„ç†-oom" aria-hidden="true">#</a> 4.å¤„ç† OOM</h2><p>å¯¹äºå¤§å‹åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œé¢å¯¹å†…å­˜ä¸è¶³é”™è¯¯æ˜¯éå¸¸å¸¸è§çš„ï¼Œè¿™åè¿‡æ¥ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºå´©æºƒã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸å…³é”®çš„åœºæ™¯ï¼Œå¾ˆéš¾é€šè¿‡å¤åˆ¶æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ JVM æä¾›äº†ä¸€äº›å‚æ•°ï¼Œè¿™äº›å‚æ•°å°†å †å†…å­˜è½¬å‚¨åˆ°ä¸€ä¸ªç‰©ç†æ–‡ä»¶ä¸­ï¼Œä»¥åå¯ä»¥ç”¨æ¥æŸ¥æ‰¾æ³„æ¼:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token parameter variable">-XX:+HeapDumpOnOutOfMemoryError</span>
<span class="token parameter variable">-XX:HeapDumpPath</span><span class="token operator">=</span>./java_pid<span class="token operator">&lt;</span>pid<span class="token operator">&gt;</span>.hprof
<span class="token parameter variable">-XX:OnOutOfMemoryError</span><span class="token operator">=</span><span class="token string">&quot;&lt; cmd args &gt;;&lt; cmd args &gt;&quot;</span>
<span class="token parameter variable">-XX:+UseGCOverheadLimit</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œæœ‰å‡ ç‚¹éœ€è¦æ³¨æ„:</p><ul><li><strong>HeapDumpOnOutOfMemoryError</strong> æŒ‡ç¤º JVM åœ¨é‡åˆ° <strong>OutOfMemoryError</strong> é”™è¯¯æ—¶å°† heap è½¬å‚¨åˆ°ç‰©ç†æ–‡ä»¶ä¸­ã€‚</li><li><strong>HeapDumpPath</strong> è¡¨ç¤ºè¦å†™å…¥æ–‡ä»¶çš„è·¯å¾„; å¯ä»¥ç»™å‡ºä»»ä½•æ–‡ä»¶å; ä½†æ˜¯ï¼Œå¦‚æœ JVM åœ¨åç§°ä¸­æ‰¾åˆ°ä¸€ä¸ª <code>&lt;pid&gt;</code> æ ‡è®°ï¼Œåˆ™å½“å‰è¿›ç¨‹çš„è¿›ç¨‹ id å°†é™„åŠ åˆ°æ–‡ä»¶åä¸­ï¼Œå¹¶ä½¿ç”¨<code>.hprof</code>æ ¼å¼</li><li><strong>OnOutOfMemoryError</strong> ç”¨äºå‘å‡ºç´§æ€¥å‘½ä»¤ï¼Œä»¥ä¾¿åœ¨å†…å­˜ä¸è¶³çš„æƒ…å†µä¸‹æ‰§è¡Œ; åº”è¯¥åœ¨ <code>cmd args</code> ç©ºé—´ä¸­ä½¿ç”¨é€‚å½“çš„å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æƒ³åœ¨å†…å­˜ä¸è¶³æ—¶é‡å¯æœåŠ¡å™¨ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®å‚æ•°: <code>-XX:OnOutOfMemoryError=&quot;shutdown -r&quot;</code> ã€‚</li><li><strong>UseGCOverheadLimit</strong> æ˜¯ä¸€ç§ç­–ç•¥ï¼Œå®ƒé™åˆ¶åœ¨æŠ›å‡º OutOfMemory é”™è¯¯ä¹‹å‰åœ¨ GC ä¸­èŠ±è´¹çš„ VM æ—¶é—´çš„æ¯”ä¾‹</li></ul><h2 id="_5-å…¶ä»–" tabindex="-1"><a class="header-anchor" href="#_5-å…¶ä»–" aria-hidden="true">#</a> 5.å…¶ä»–</h2><ul><li><code>-server</code> : å¯ç”¨â€œ Server Hotspot VMâ€; æ­¤å‚æ•°é»˜è®¤ç”¨äº 64 ä½ JVM</li><li><code>-XX:+UseStringDeduplication</code> : <em>Java 8u20</em> å¼•å…¥äº†è¿™ä¸ª JVM å‚æ•°ï¼Œé€šè¿‡åˆ›å»ºå¤ªå¤šç›¸åŒ String çš„å®ä¾‹æ¥å‡å°‘ä¸å¿…è¦çš„å†…å­˜ä½¿ç”¨; è¿™é€šè¿‡å°†é‡å¤ String å€¼å‡å°‘ä¸ºå•ä¸ªå…¨å±€ <code>char []</code> æ•°ç»„æ¥ä¼˜åŒ–å †å†…å­˜ã€‚</li><li><code>-XX:+UseLWPSynchronization</code>: è®¾ç½®åŸºäº LWP (è½»é‡çº§è¿›ç¨‹)çš„åŒæ­¥ç­–ç•¥ï¼Œè€Œä¸æ˜¯åŸºäºçº¿ç¨‹çš„åŒæ­¥ã€‚</li><li><code>-XX:LargePageSizeInBytes</code>: è®¾ç½®ç”¨äº Java å †çš„è¾ƒå¤§é¡µé¢å¤§å°; å®ƒé‡‡ç”¨ GB/MB/KB çš„å‚æ•°; é¡µé¢å¤§å°è¶Šå¤§ï¼Œæˆ‘ä»¬å¯ä»¥æ›´å¥½åœ°åˆ©ç”¨è™šæ‹Ÿå†…å­˜ç¡¬ä»¶èµ„æº; ç„¶è€Œï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´ PermGen çš„ç©ºé—´å¤§å°æ›´å¤§ï¼Œè¿™åè¿‡æ¥åˆä¼šè¿«ä½¿ Java å †ç©ºé—´çš„å¤§å°å‡å°ã€‚</li><li><code>-XX:MaxHeapFreeRatio</code> : è®¾ç½® GC å, å †ç©ºé—²çš„æœ€å¤§ç™¾åˆ†æ¯”ï¼Œä»¥é¿å…æ”¶ç¼©ã€‚</li><li><code>-XX:SurvivorRatio</code> : eden/survivor ç©ºé—´çš„æ¯”ä¾‹, ä¾‹å¦‚<code>-XX:SurvivorRatio=6</code> è®¾ç½®æ¯ä¸ª survivor å’Œ eden ä¹‹é—´çš„æ¯”ä¾‹ä¸º 1:6ã€‚</li><li><code>-XX:+UseLargePages</code> : å¦‚æœç³»ç»Ÿæ”¯æŒï¼Œåˆ™ä½¿ç”¨å¤§é¡µé¢å†…å­˜; è¯·æ³¨æ„ï¼Œå¦‚æœä½¿ç”¨è¿™ä¸ª JVM å‚æ•°ï¼ŒOpenJDK 7 å¯èƒ½ä¼šå´©æºƒã€‚</li><li><code>-XX:+UseStringCache</code> : å¯ç”¨ String æ± ä¸­å¯ç”¨çš„å¸¸ç”¨åˆ†é…å­—ç¬¦ä¸²çš„ç¼“å­˜ã€‚</li><li><code>-XX:+UseCompressedStrings</code> : å¯¹ String å¯¹è±¡ä½¿ç”¨ <code>byte []</code> ç±»å‹ï¼Œè¯¥ç±»å‹å¯ä»¥ç”¨çº¯ ASCII æ ¼å¼è¡¨ç¤ºã€‚</li><li><code>-XX:+OptimizeStringConcat</code> : å®ƒå°½å¯èƒ½ä¼˜åŒ–å­—ç¬¦ä¸²ä¸²è”æ“ä½œã€‚</li></ul><h2 id="æ–‡ç« æ¨è" tabindex="-1"><a class="header-anchor" href="#æ–‡ç« æ¨è" aria-hidden="true">#</a> æ–‡ç« æ¨è</h2><p>è¿™é‡Œæ¨èäº†éå¸¸å¤šä¼˜è´¨çš„ JVM å®è·µç›¸å…³çš„æ–‡ç« ï¼Œæ¨èé˜…è¯»ï¼Œå°¤å…¶æ˜¯ JVM æ€§èƒ½ä¼˜åŒ–å’Œé—®é¢˜æ’æŸ¥ç›¸å…³çš„æ–‡ç« ã€‚</p>`,13),N={href:"https://help.aliyun.com/document_detail/148851.html",target:"_blank",rel:"noopener noreferrer"},P={href:"https://help.aliyun.com/document_detail/383255.html",target:"_blank",rel:"noopener noreferrer"},B={href:"https://segmentfault.com/a/1190000039806436",target:"_blank",rel:"noopener noreferrer"},E={href:"https://juejin.cn/post/7078624931826794503",target:"_blank",rel:"noopener noreferrer"},j={href:"https://heapdump.cn/article/1859160",target:"_blank",rel:"noopener noreferrer"},q={href:"https://shuyi.tech/archives/have-a-try-in-jvm-combat",target:"_blank",rel:"noopener noreferrer"},D={href:"https://mp.weixin.qq.com/s/df1uxHWUXzhErxW1sZ6OvQ",target:"_blank",rel:"noopener noreferrer"},U={href:"https://tech.meituan.com/2020/11/12/java-9-cms-gc.html",target:"_blank",rel:"noopener noreferrer"},H={href:"https://tech.meituan.com/2017/12/29/jvm-optimize.html",target:"_blank",rel:"noopener noreferrer"};function L(F,R){const n=i("ExternalLinkIcon");return o(),l("div",null,[e("blockquote",null,[e("p",null,[a("æœ¬æ–‡ç”± JavaGuide ç¿»è¯‘è‡ª "),e("a",d,[a("https://www.baeldung.com/jvm-parameters"),s(n)]),a("ï¼Œå¹¶å¯¹æ–‡ç« è¿›è¡Œäº†å¤§é‡çš„å®Œå–„è¡¥å……ã€‚")]),u]),m,e("p",null,[a("æ ¹æ®"),e("a",v,[a("Oracle å®˜æ–¹æ–‡æ¡£"),s(n)]),a("ï¼Œåœ¨å †æ€»å¯ç”¨å†…å­˜é…ç½®å®Œæˆä¹‹åï¼Œç¬¬äºŒå¤§å½±å“å› ç´ æ˜¯ä¸º "),h,a(" åœ¨å †å†…å­˜æ‰€å çš„æ¯”ä¾‹ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒYG çš„æœ€å°å¤§å°ä¸º 1310 "),b,a("ï¼Œæœ€å¤§å¤§å°ä¸º"),g,a("ã€‚")]),_,e("p",null,[e("strong",null,[a("ğŸ› ä¿®æ­£ï¼ˆå‚è§ï¼š"),e("a",k,[a("issue#1947"),s(n)]),a("ï¼‰")]),a("ï¼š")]),X,e("p",null,[a("å¯ä»¥å‚è€ƒ Oracle å®˜æ–¹æ–‡æ¡£ "),e("a",f,[a("Other Considerations"),s(n)]),a(" ä¸­æåˆ°çš„ï¼š")]),M,e("p",null,[a("å¦å¤–ï¼Œè¿˜å¯ä»¥çœ‹ä¸€ä¸‹è¿™ä¸ªè¯•éªŒï¼š"),e("a",x,[a("JVM å‚æ•° MetaspaceSize çš„è¯¯è§£"),s(n)]),a("ã€‚")]),G,e("p",null,[a("ç›¸å…³é˜…è¯»ï¼š"),e("a",S,[a("issue æ›´æ­£ï¼šMaxMetaspaceSize å¦‚æœä¸æŒ‡å®šå¤§å°çš„è¯ï¼Œä¸ä¼šè€—å°½å†…å­˜ #1204 "),s(n)]),a(" ã€‚")]),C,z,e("p",null,[a("ä¸ºäº†æé«˜åº”ç”¨ç¨‹åºçš„ç¨³å®šæ€§ï¼Œé€‰æ‹©æ­£ç¡®çš„"),e("a",J,[a("åƒåœ¾æ”¶é›†"),s(n)]),a("ç®—æ³•è‡³å…³é‡è¦ã€‚")]),O,e("p",null,[a("æœ‰å…³"),w,a("å®æ–½çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§"),e("a",y,[a("æ­¤å¤„"),s(n)]),a("ã€‚")]),V,e("ul",null,[e("li",null,[e("a",N,[a("JVM å‚æ•°é…ç½®è¯´æ˜ - é˜¿é‡Œäº‘å®˜æ–¹æ–‡æ¡£ - 2022"),s(n)])]),e("li",null,[e("a",P,[a("JVM å†…å­˜é…ç½®æœ€ä½³å®è·µ - é˜¿é‡Œäº‘å®˜æ–¹æ–‡æ¡£ - 2022"),s(n)])]),e("li",null,[e("a",B,[a("æ±‚ä½ äº†ï¼ŒGC æ—¥å¿—æ‰“å°åˆ«å†çé…ç½®äº† - æ€å¦ - 2022"),s(n)])]),e("li",null,[e("a",E,[a("ä¸€æ¬¡å¤§é‡ JVM Native å†…å­˜æ³„éœ²çš„æ’æŸ¥åˆ†æï¼ˆ64M é—®é¢˜ï¼‰ - æ˜é‡‘ - 2022"),s(n)])]),e("li",null,[e("a",j,[a("ä¸€æ¬¡çº¿ä¸Š JVM è°ƒä¼˜å®è·µï¼ŒFullGC40 æ¬¡/å¤©åˆ° 10 å¤©ä¸€æ¬¡çš„ä¼˜åŒ–è¿‡ç¨‹ - HeapDump - 2021"),s(n)])]),e("li",null,[e("a",q,[a("å¬è¯´ JVM æ€§èƒ½ä¼˜åŒ–å¾ˆéš¾ï¼Ÿä»Šå¤©æˆ‘å°è¯•äº†ä¸€æŠŠï¼ - é™ˆæ ‘ä¹‰ - 2021"),s(n)])]),e("li",null,[e("a",D,[a("ä½ ä»¬è¦çš„çº¿ä¸Š GC é—®é¢˜æ¡ˆä¾‹æ¥å•¦ - ç¼–äº†ä¸ªç¨‹ - 2021"),s(n)])]),e("li",null,[e("a",U,[a("Java ä¸­ 9 ç§å¸¸è§çš„ CMS GC é—®é¢˜åˆ†æä¸è§£å†³ - ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ - 2020"),s(n)])]),e("li",null,[e("a",H,[a("ä»å®é™…æ¡ˆä¾‹èŠèŠ Java åº”ç”¨çš„ GC ä¼˜åŒ–-ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ - ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ - 2017"),s(n)])])])])}const I=r(p,[["render",L],["__file","jvm-parameters-intro.html.vue"]]);export{I as default};
