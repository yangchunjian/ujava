<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.15" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.56" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://ujava.cn/assembly/rocket.html"><meta property="og:site_name" content="UJava"><meta property="og:title" content="组件Rocket"><meta property="og:description" content="简介 RocketMQ是由阿里捐赠给Apache的一款低延迟、高并发、高可用、高可靠的分布式消息中间件。经历了淘宝双十一的洗礼。RocketMQ既可为分布式应用系统提供异步解耦和削峰填谷的能力，同时也具备互联网应用所需的海量消息堆积、高吞吐、可靠重试等特性。 核心概念 Topic：消息主题，一级消息类型，生产者向其发送消息。 Message：生产者向T..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-09-29T15:25:53.000Z"><meta property="article:tag" content="组件"><meta property="article:modified_time" content="2024-09-29T15:25:53.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"组件Rocket","image":[""],"dateModified":"2024-09-29T15:25:53.000Z","author":[{"@type":"Person","name":"UJava","url":"https://ujava.cn/article/"}]}</script><meta name="robots" content="all"><meta name="author" content="ujava"><meta name="baidu-site-verification" content="codeva-wnNGUni4cx"><meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Expires" content="0"><meta name="keywords" content="Java基础, 多线程, JVM, 虚拟机, 数据库, MySQL, Spring, Redis, MyBatis, 系统设计, 分布式, RPC, 高可用, 高并发"><meta name="apple-mobile-web-app-capable" content="yes"><script>var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?d44ac18afe199d84cbb99448b4b9baec";
          var s = document.getElementsByTagName("script")[0]; 
          s.parentNode.insertBefore(hm, s);
        })();</script><link rel="alternate" type="application/atom+xml" href="https://ujava.cn/atom.xml" title="UJava Atom Feed"><link rel="alternate" type="application/json" href="https://ujava.cn/feed.json" title="UJava JSON Feed"><link rel="alternate" type="application/rss+xml" href="https://ujava.cn/rss.xml" title="UJava RSS Feed"><link rel="icon" href="/favicon.ico"><title>组件Rocket | UJava</title><meta name="description" content="简介 RocketMQ是由阿里捐赠给Apache的一款低延迟、高并发、高可用、高可靠的分布式消息中间件。经历了淘宝双十一的洗礼。RocketMQ既可为分布式应用系统提供异步解耦和削峰填谷的能力，同时也具备互联网应用所需的海量消息堆积、高吞吐、可靠重试等特性。 核心概念 Topic：消息主题，一级消息类型，生产者向其发送消息。 Message：生产者向T...">
    <link rel="preload" href="/assets/style-CV2o7NCs.css" as="style"><link rel="stylesheet" href="/assets/style-CV2o7NCs.css">
    <link rel="modulepreload" href="/assets/app-CZKXz-g7.js"><link rel="modulepreload" href="/assets/rocket.html-5WZ3Oq-F.js">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><!--[--><div class="theme-container external-link-icon pure has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/" aria-label="带我回家"><img class="vp-nav-logo" src="/logo/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">UJava</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/required/" aria-label="快速上手"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><!--]-->快速上手<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/mind/" aria-label="设计思想"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><!--]-->设计思想<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/design/" aria-label="设计模式"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><!--]-->设计模式<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="项目相关"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span>项目相关<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/home.html" aria-label="项目介绍"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><!--]-->项目介绍<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/project/changelog.html" aria-label="更新记录"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><!--]-->更新记录<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/manage/" aria-label="管理经验"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><!--]-->管理经验<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="网站相关"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span>网站相关<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/category/" aria-label="网站分类"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><!--]-->网站分类<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/tag/" aria-label="网站标签"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><!--]-->网站标签<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/timeline/" aria-label="网站历史"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><!--]-->网站历史<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="应用相关"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span>应用相关<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/app/wechat.html" aria-label="公众号"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><!--]-->公众号<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/app/applet.html" aria-label="小程序"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><!--]-->小程序<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/app/pack.html" aria-label="安装包"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><!--]-->安装包<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="游戏相关"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span>游戏相关<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="auto-link external-link" href="https://ujava.cn/2048" aria-label="2048" rel="noopener noreferrer" target="_blank"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><!--]-->2048<!----></a></li><li class="vp-dropdown-item"><a class="auto-link external-link" href="https://ujava.cn/pacman" aria-label="吃豆人" rel="noopener noreferrer" target="_blank"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><!--]-->吃豆人<!----></a></li><li class="vp-dropdown-item"><a class="auto-link external-link" href="https://ujava.cn/jump" aria-label="跳一跳" rel="noopener noreferrer" target="_blank"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><!--]-->跳一跳<!----></a></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><!----><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><form class="search-box" role="search"><input type="search" placeholder="搜索" autocomplete="off" spellcheck="false" value><!----></form><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><span class="vp-sidebar-title">必读</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><span class="vp-sidebar-title">设计思想</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><span class="vp-sidebar-title">设计注意</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><span class="vp-sidebar-title">设计基础</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><span class="vp-sidebar-title">设计原理</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><span class="vp-sidebar-title">设计模式</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><span class="vp-sidebar-title">设计规范</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><span class="vp-sidebar-title">设计框架</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><span class="vp-sidebar-title">设计组件</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/apollo.html" aria-label="组件Apollo"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件Apollo<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/devops.html" aria-label="组件DevOps"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件DevOps<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/disconf.html" aria-label="组件Disconf"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件Disconf<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/dubbo.html" aria-label="组件Dubbo"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件Dubbo<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/elasticsearch.html" aria-label="组件ElasticSearch"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件ElasticSearch<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/erp.html" aria-label="组件ERP"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件ERP<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/eureka.html" aria-label="组件Eureka"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件Eureka<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/flink.html" aria-label="组件Flink"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件Flink<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/flume.html" aria-label="组件Flume"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件Flume<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/hadoop.html" aria-label="组件Hadoop"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件Hadoop<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/hbase.html" aria-label="组件Hbase"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件Hbase<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/hive.html" aria-label="组件Hive"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件Hive<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/hystrix.html" aria-label="组件Hystrix"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件Hystrix<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/jenkins.html" aria-label="组件Jenkins"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件Jenkins<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/kafka.html" aria-label="组件Kafka"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件Kafka<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/k8s.html" aria-label="组件Kubernetes"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件Kubernetes<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/matlab.html" aria-label="组件MatLab"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件MatLab<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/mock.html" aria-label="组件Mock"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件Mock<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/mongodb.html" aria-label="组件MongoDB"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件MongoDB<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/mq.html" aria-label="组件MQ"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件MQ<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/mybatis.html" aria-label="组件MyBatis"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件MyBatis<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/mysql.html" aria-label="组件MySQL"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件MySQL<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/netty.html" aria-label="组件Netty"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件Netty<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/nocas.html" aria-label="组件Nocas"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件Nocas<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/reactor.html" aria-label="组件Reactor"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件Reactor<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/redis.html" aria-label="组件Redis"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件Redis<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/assembly/rocket.html" aria-label="组件Rocket"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件Rocket<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/serverless.html" aria-label="组件Serverless"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件Serverless<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/spark.html" aria-label="组件Spark"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件Spark<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/spring.html" aria-label="组件Spring"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件Spring<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/springboot.html" aria-label="组件SpringBoot"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件SpringBoot<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/springcloud.html" aria-label="组件SpringCloud"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件SpringCloud<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/springmvc.html" aria-label="组件SpringMVC"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件SpringMVC<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/container.html" aria-label="组件Web"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件Web<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/webflux.html" aria-label="组件WebFlux"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件WebFlux<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/xxljob.html" aria-label="组件XXL-JOB"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件XXL-JOB<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/zookeeper.html" aria-label="组件ZooKeeper"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件ZooKeeper<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/assembly/0template.html" aria-label="组件模版"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->组件模版<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><span class="vp-sidebar-title">设计算法</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><span class="vp-sidebar-title">设计Java</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><span class="vp-sidebar-title">设计综合</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><span class="vp-sidebar-title">项目管理</span><span class="vp-arrow end"></span></button><!----></section></li></ul><!----></aside><!--[--><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>组件Rocket</h1><div class="page-info"><span class="page-author-info" aria-label="作者"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://ujava.cn/article/" target="_blank" rel="noopener noreferrer">UJava</a></span><span property="author" content="UJava"></span></span><span class="page-category-info" aria-label="分类"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item clickable" role="navigation">设计组件</span><!--]--><meta property="articleSection" content="设计组件"></span><span class="page-tag-info" aria-label="标签"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item clickable" role="navigation">组件</span><!--]--><meta property="keywords" content="组件"></span><!----><span class="page-word-info" aria-label="字数"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon" name="word"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>约 5099 字</span><meta property="wordCount" content="5099"></span><span class="page-reading-time-info" aria-label="阅读时间"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 17 分钟</span><meta property="timeRequired" content="PT17M"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#简介">简介</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#核心概念">核心概念</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#消息收发模型">消息收发模型</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#应用场景">应用场景</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#异步解耦">异步解耦</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#分布式事务的数据一致性">分布式事务的数据一致性</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#消息的顺序收发">消息的顺序收发</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#削峰填谷">削峰填谷</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#大规模机器的缓存同步">大规模机器的缓存同步</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#系统部署架构">系统部署架构</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content" vp-content><h2 id="简介" tabindex="-1"><a class="header-anchor" href="#简介"><span>简介</span></a></h2><p>RocketMQ是由阿里捐赠给Apache的一款低延迟、高并发、高可用、高可靠的分布式消息中间件。经历了淘宝双十一的洗礼。RocketMQ既可为分布式应用系统提供异步解耦和削峰填谷的能力，同时也具备互联网应用所需的海量消息堆积、高吞吐、可靠重试等特性。</p><h2 id="核心概念" tabindex="-1"><a class="header-anchor" href="#核心概念"><span>核心概念</span></a></h2><ul><li><p><strong>Topic</strong>：消息主题，一级消息类型，生产者向其发送消息。</p></li><li><p><strong>Message</strong>：生产者向Topic发送并最终传送给消费者的数据消息的载体。</p></li><li><p><strong>消息属性</strong>：生产者可以为消息定义的属性，包含Message Key和Tag。</p></li><li><p><strong>Message Key</strong>：消息的业务标识，由消息生产者（Producer）设置，唯一标识某个业务逻辑。</p></li><li><p><strong>Message ID</strong>：消息的全局唯一标识，由消息队列RocketMQ系统自动生成，唯一标识某条消息。</p></li><li><p><strong>Tag</strong>：消息标签，二级消息类型，用来进一步区分某个Topic下的消息分类</p></li><li><p><strong>Producer</strong>：也称为消息发布者，负责生产并发送消息至Topic。</p></li><li><p><strong>Consumer</strong>：也称为消息订阅者，负责从Topic接收并消费消息。</p></li><li><p><strong>分区</strong>：即Topic Partition，物理上的概念。每个Topic包含一个或多个分区。</p></li><li><p><strong>消费位点</strong>：每个Topic会有多个分区，每个分区会统计当前消息的总条数，这个称为最大位点MaxOffset；分区的起始位置对应的位置叫做起始位点MinOffset。</p></li><li><p><strong>Group</strong>：一类生产者或消费者，这类生产者或消费者通常生产或消费同一类消息，且消息发布或订阅的逻辑一致。</p></li><li><p><strong>Group ID</strong>：Group的标识。</p></li><li><p><strong>队列</strong>：个Topic下会由一到多个队列来存储消息。</p></li><li><p><strong>Exactly-Once投递语义</strong>：Exactly-Once投递语义是指发送到消息系统的消息只能被Consumer处理且仅处理一次，即使Producer重试消息发送导致某消息重复投递，该消息在Consumer也只被消费一次。</p></li><li><p><strong>集群消费</strong>：一个Group ID所标识的所有Consumer平均分摊消费消息。例如某个Topic有9条消息，一个Group ID有3个Consumer实例，那么在集群消费模式下每个实例平均分摊，只消费其中的3条消息。</p></li><li><p><strong>广播消费</strong>：一个Group ID所标识的所有Consumer都会各自消费某条消息一次。例如某个Topic有9条消息，一个Group ID有3个Consumer实例，那么在广播消费模式下每个实例都会各自消费9条消息。</p></li><li><p><strong>定时消息</strong>：Producer将消息发送到消息队列RocketMQ服务端，但并不期望这条消息立马投递，而是推迟到在当前时间点之后的某一个时间投递到Consumer进行消费，该消息即定时消息。</p></li><li><p><strong>延时消息</strong>：Producer将消息发送到消息队列RocketMQ服务端，但并不期望这条消息立马投递，而是延迟一定时间后才投递到Consumer进行消费，该消息即延时消息。</p></li><li><p><strong>事务消息</strong>：RocketMQ提供类似X/Open XA的分布事务功能，通过消息队列RocketMQ的事务消息能达到分布式事务的最终一致。</p></li><li><p><strong>顺序消息</strong>：RocketMQ提供的一种按照顺序进行发布和消费的消息类型，分为全局顺序消息和分区顺序消息。</p></li><li><p><strong>全局顺序消息</strong>：对于指定的一个Topic，所有消息按照严格的先入先出（FIFO）的顺序进行发布和消费。</p></li><li><p><strong>分区顺序消息</strong>：对于指定的一个Topic，所有消息根据Sharding Key进行区块分区。同一个分区内的消息按照严格的FIFO顺序进行发布和消费。Sharding Key是顺序消息中用来区分不同分区的关键字段，和普通消息的Message Key是完全不同的概念。</p></li><li><p><strong>消息堆积</strong>：Producer已经将消息发送到消息队列RocketMQ的服务端，但由于Consumer消费能力有限，未能在短时间内将所有消息正确消费掉，此时在消息队列RocketMQ的服务端保存着未被消费的消息，该状态即消息堆积。</p></li><li><p><strong>消息过滤</strong>：Consumer可以根据消息标签（Tag）对消息进行过滤，确保Consumer最终只接收被过滤后的消息类型。消息过滤在消息队列RocketMQ的服务端完成。</p></li><li><p><strong>消息轨迹</strong>：在一条消息从Producer发出到Consumer消费处理过程中，由各个相关节点的时间、地点等数据汇聚而成的完整链路信息。通过消息轨迹，您能清晰定位消息从Producer发出，经由消息队列RocketMQ服务端，投递给Consumer的完整链路，方便定位排查问题。</p></li><li><p><strong>重置消费位点</strong>：以时间轴为坐标，在消息持久化存储的时间范围内（默认3天），重新设置Consumer对已订阅的Topic的消费进度，设置完成后Consumer将接收设定时间点之后由Producer发送到消息队列RocketMQ服务端的消息。</p></li><li><p><strong>死信队列</strong>：死信队列用于处理无法被正常消费的消息。当一条消息初次消费失败，消息队列RocketMQ会自动进行消息重试；达到最大重试次数后，若消费依然失败，则表明Consumer在正常情况下无法正确地消费该消息。此时，消息队列RocketMQ不会立刻将消息丢弃，而是将这条消息发送到该Consumer对应的特殊队列中。  消息队列RocketMQ将这种正常情况下无法被消费的消息称为死信消息（Dead-Letter Message），将存储死信消息的特殊队列称为死信队列（Dead-Letter Queue）。</p></li></ul><h2 id="消息收发模型" tabindex="-1"><a class="header-anchor" href="#消息收发模型"><span>消息收发模型</span></a></h2><p>消息队列RocketMQ支持发布和订阅模型，消息生产者应用创建Topic并将消息发送到Topic。消费者应用创建对Topic的订阅以便从其接收消息。通信可以是一对多（扇出）、多对一（扇入）和多对多。具体通信如下图所示。<br><img src="/assets/img_221-DtKffIes.png" alt="img_221.png" loading="lazy"></p><ul><li><p><strong>生产者集群</strong>：用来表示发送消息应用，一个生产者集群下包含多个生产者实例，可以是多台机器，也可以是一台机器的多个进程，或者一个进程的多个生产者对象。  一个生产者集群可以发送多个Topic消息。发送分布式事务消息时，如果生产者中途意外宕机，消息队列RocketMQ服务端会主动回调生产者集群的任意一台机器来确认事务状态。</p></li><li><p><strong>消费者集群</strong>：用来表示消费消息应用，一个消费者集群下包含多个消费者实例，可以是多台机器，也可以是多个进程，或者是一个进程的多个消费者对象。一个消费者集群下的多个消费者以均摊方式消费消息。如果设置的是广播方式，那么这个消费者集群下的每个实例都消费全量数据。  一个消费者集群对应一个Group ID，一个Group ID可以订阅多个Topic，如上图中的Group 2所示。Group和Topic的订阅关系可以通过直接在程序中设置即可。</p></li></ul><h2 id="应用场景" tabindex="-1"><a class="header-anchor" href="#应用场景"><span>应用场景</span></a></h2><ul><li><p><strong>削峰填谷</strong>：诸如秒杀、抢红包、企业开门红等大型活动时皆会带来较高的流量脉冲，或因没做相应的保护而导致系统超负荷甚至崩溃，或因限制太过导致请求大量失败而影响用户体验，消息队列RocketMQ可提供削峰填谷的服务来解决该问题。</p></li><li><p><strong>异步解耦</strong>：交易系统作为淘宝和天猫主站最核心的系统，每笔交易订单数据的产生会引起几百个下游业务系统的关注，包括物流、购物车、积分、流计算分析等等，整体业务系统庞大而且复杂，消息队列RocketMQ可实现异步通信和应用解耦，确保主站业务的连续性。</p></li><li><p><strong>顺序收发</strong>：细数日常中需要保证顺序的应用场景非常多，例如证券交易过程时间优先原则，交易系统中的订单创建、支付、退款等流程，航班中的旅客登机消息处理等等。与先进先出FIFO（First In First Out）原理类似，消息队列RocketMQ提供的顺序消息即保证消息FIFO。</p></li><li><p><strong>分布式事务一致性</strong>：交易系统、支付红包等场景需要确保数据的最终一致性，大量引入消息队列RocketMQ的分布式事务，既可以实现系统之间的解耦，又可以保证最终的数据一致性。</p></li><li><p><strong>大数据分析</strong>：数据在“流动”中产生价值，传统数据分析大多是基于批量计算模型，而无法做到实时的数据分析，利用阿里云消息队列RocketMQ与流式计算引擎相结合，可以很方便的实现业务数据的实时分析。</p></li><li><p><strong>分布式缓存同步</strong>：天猫双11大促，各个分会场琳琅满目的商品需要实时感知价格变化，大量并发访问数据库导致会场页面响应时间长，集中式缓存因带宽瓶颈，限制了商品变更的访问流量，通过消息队列RocketMQ构建分布式缓存，实时通知商品数据的变化。</p></li></ul><p>下文先以用户注册为场景说明消息队列RocketMQ如何实现以下功能：</p><ul><li><p>异步解耦</p></li><li><p>分布式事务的数据一致性</p></li><li><p>消息的顺序收发</p></li></ul><p>最后，再以电商的秒杀场景和价格同步场景分别说明消息队列RocketMQ所实现的削峰填谷和大规模机器的缓存同步。</p><h3 id="异步解耦" tabindex="-1"><a class="header-anchor" href="#异步解耦"><span>异步解耦</span></a></h3><h4 id="传统处理" tabindex="-1"><a class="header-anchor" href="#传统处理"><span>传统处理</span></a></h4><p>最常见的一个场景是用户注册后，需要发送注册邮件和短信通知，以告知用户注册成功。传统的做法有以下两种：</p><p><strong>串行方式</strong><br><img src="/assets/img_222-c_2d-BYH.png" alt="img_222.png" loading="lazy"></p><p>数据流动如下所述：</p><ol><li><p>您在注册页面填写账号和密码并提交注册信息，这些注册信息首先会被写入注册系统。</p></li><li><p>注册信息写入注册系统成功后，再发送请求至邮件通知系统。邮件通知系统收到请求后向用户发送邮件通知。</p></li><li><p>邮件通知系统接收注册系统请求后再向下游的短信通知系统发送请求。短信通知系统收到请求后向用户发送短信通知。</p></li></ol><p>以上三个任务全部完成后，才返回注册结果到客户端，用户才能使用账号登录。<br> 假设每个任务耗时分别为50 ms，则用户需要在注册页面等待总共150 ms才能登录。</p><p><strong>并行方式</strong><br><img src="/assets/img_223-CJtAD8SF.png" alt="img_223.png" loading="lazy"></p><p>数据流动如下所述：</p><ol><li><p>用户在注册页面填写账号和密码并提交注册信息，这些注册信息首先会被写入注册系统。</p></li><li><p>注册信息写入注册系统成功后，再同时发送请求至邮件和短信通知系统。邮件和短信通知系统收到请求后分别向用户发送邮件和短信通知。</p></li></ol><p>以上两个任务全部完成后，才返回注册结果到客户端，用户才能使用账号登录。  假设每个任务耗时分别为50 ms，其中，邮件和短信通知并行完成，则用户需要在注册页面等待总共100 ms才能登录。</p><h4 id="异步解耦-1" tabindex="-1"><a class="header-anchor" href="#异步解耦-1"><span>异步解耦</span></a></h4><p>对于用户来说，注册功能实际只需要注册系统存储用户的账户信息后，该用户便可以登录，后续的注册短信和邮件不是即时需要关注的步骤。</p><p>对于注册系统而言，发送注册成功的短信和邮件通知并不一定要绑定在一起同步完成，所以实际当数据写入注册系统后，注册系统就可以把其他的操作放入对应的消息队列RocketMQ中然后马上返回用户结果，由消息队列RocketMQ异步地进行这些操作。<br><img src="/assets/img_224-Bap_R5ro.png" alt="img_224.png" loading="lazy"></p><p>数据流动如下所述：</p><ol><li><p>用户在注册页面填写账号和密码并提交注册信息，这些注册信息首先会被写入注册系统。</p></li><li><p>注册信息写入注册系统成功后，再发送消息至消息队列RocketMQ。消息队列RocketMQ会马上返回响应给注册系统，注册完成。用户可立即登录。</p></li><li><p>下游的邮件和短信通知系统订阅消息队列RocketMQ的此类注册请求消息，即可向用户发送邮件和短信通知，完成所有的注册流程。</p></li></ol><p>用户只需在注册页面等待注册数据写入注册系统和消息队列RocketMQ的时间，即等待55 ms即可登录。</p><p>异步解耦是消息队列RocketMQ的主要特点，主要目的是减少请求响应时间和解耦。主要的适用场景就是将比较耗时而且不需要即时（同步）返回结果的操作作为消息放入消息队列。同时，由于使用了消息队列RocketMQ，只要保证消息格式不变，消息的发送方和接收方并不需要彼此联系，也不需要受对方的影响，即解耦。</p><h3 id="分布式事务的数据一致性" tabindex="-1"><a class="header-anchor" href="#分布式事务的数据一致性"><span>分布式事务的数据一致性</span></a></h3><p>注册系统注册的流程中，用户入口在网页注册系统，通知系统在邮件系统，两个系统之间的数据需要保持最终一致。</p><h4 id="普通消息处理" tabindex="-1"><a class="header-anchor" href="#普通消息处理"><span>普通消息处理</span></a></h4><p>如上所述，注册系统和邮件通知系统之间通过消息队列进行异步处理。注册系统将注册信息写入注册系统之后，发送一条注册成功的消息到消息队列RocketMQ，邮件通知系统订阅消息队列RocketMQ的注册消息，做相应的业务处理，发送注册成功或者失败的邮件。<br><img src="/assets/img_225-BpvH2HxW.png" alt="img_225.png" loading="lazy"></p><p>流程说明如下：</p><ol><li><p>注册系统发起注册。</p></li><li><p>注册系统向消息队列RocketMQ发送注册消息成功与否的消息。</p></li></ol><p>2.1. 消息发送成功，进入3。</p><p>2.2. 消息发送失败，导致邮件通知系统未收到消息队列RocketMQ发送的注册成功与否的消               息，而无法发送邮件，最终邮件通知系统和注册系统之间的状态数据不一致。</p><ol start="3"><li><p>邮件通知系统收到消息队列RocketMQ的注册成功消息。</p></li><li><p>邮件通知系统发送注册成功邮件给用户。</p></li></ol><p>在这样的情况下，虽然实现了系统间的解耦，上游系统不需要关心下游系统的业务处理结果；但是数据一致性不好处理，如何保证邮件通知系统状态与注册系统状态的最终一致。</p><h4 id="事务消息处理" tabindex="-1"><a class="header-anchor" href="#事务消息处理"><span>事务消息处理</span></a></h4><p>此时，需要利用消息队列RocketMQ所提供的事务消息来实现系统间的状态数据一致性。<br><img src="/assets/img_226-DA9z07F6.png" alt="img_226.png" loading="lazy"></p><p>流程说明如下：</p><ol><li>注册系统向消息队列RocketMQ发送半事务消息。</li></ol><p>1.1. 半事务消息发送成功，进入2。</p><p>1.2. 半事务消息发送失败，注册系统不进行注册，流程结束。（最终注册系统与邮件通知系统数据一致）</p><ol start="2"><li>注册系统开始注册。</li></ol><p>2.1. 注册成功，进入3.1。</p><p>2.2. 注册失败，进入3.2。</p><ol start="3"><li>注册系统向消息队列RocketMQ发送半消息状态。</li></ol><p>3.1. 提交半事务消息，产生注册成功消息，进入4。</p><p>3.2. 回滚半事务消息，未产生注册成功消息，流程结束。  说明 最终注册系统与邮件通知系    统数据一致。</p><ol start="4"><li><p>邮件通知系统接收消息队列RocketMQ的注册成功消息。</p></li><li><p>邮件通知系统发送注册成功邮件。（最终注册系统与邮件通知系统数据一致）关于分布式事务消息的更多详细内容，请参见事务消息。</p></li></ol><h3 id="消息的顺序收发" tabindex="-1"><a class="header-anchor" href="#消息的顺序收发"><span>消息的顺序收发</span></a></h3><p>消息队列RocketMQ顺序消息分为两种情况：</p><ul><li><p>全局顺序：对于指定的一个Topic，所有消息将按照严格的先入先出（FIFO）的顺序，进行顺序发布和顺序消费。</p></li><li><p>分区顺序：对于指定的一个Topic，所有消息根据Sharding Key进行区块分区，同一个分区内的消息将按照严格的FIFO的顺序，进行顺序发布和顺序消费，可以保证一个消息被一个进程消费。在注册场景中，可使用用户ID作为Sharding Key来进行分区，同一个分区下的新建、更新或删除注册信息的消息必须按照FIFO的顺序发布和消费。</p></li></ul><h3 id="削峰填谷" tabindex="-1"><a class="header-anchor" href="#削峰填谷"><span>削峰填谷</span></a></h3><p>流量削峰也是消息队列RocketMQ的常用场景，一般在秒杀或团队抢购活动中使用广泛。</p><p>在秒杀或团队抢购活动中，由于用户请求量较大，导致流量暴增，秒杀的应用在处理如此大量的访问流量后，下游的通知系统无法承载海量的调用量，甚至会导致系统崩溃等问题而发生漏通知的情况。为解决这些问题，可在应用和下游通知系统之间加入消息队列RocketMQ。<br><img src="/assets/img_227-BVCFTd94.png" alt="img_227.png" loading="lazy"></p><p>秒杀处理流程如下所述：</p><ol><li><p>用户发起海量秒杀请求到秒杀业务处理系统。</p></li><li><p>秒杀处理系统按照秒杀处理逻辑将满足秒杀条件的请求发送至消息队列RocketMQ。</p></li><li><p>下游的通知系统订阅消息队列RocketMQ的秒杀相关消息，再将秒杀成功的消息发送到相应用户。</p></li><li><p>用户收到秒杀成功的通知。</p></li></ol><h3 id="大规模机器的缓存同步" tabindex="-1"><a class="header-anchor" href="#大规模机器的缓存同步"><span>大规模机器的缓存同步</span></a></h3><p>双十一大促时，各个分会场会有玲琅满目的商品，每件商品的价格都会实时变化。使用缓存技术也无法满足对商品价格的访问需求，缓存服务器网卡满载。访问较多次商品价格查询影响会场页面的打开速度。</p><p>此时需要提供一种广播机制，一条消息本来只可以被集群的一台机器消费，如果使用消息队列RocketMQ的广播消费模式，那么这条消息会被所有节点消费一次，相当于把价格信息同步到需要的每台机器上，取代缓存的作用。</p><h2 id="系统部署架构" tabindex="-1"><a class="header-anchor" href="#系统部署架构"><span>系统部署架构</span></a></h2><p>系统部署架构如下图所示。<br><img src="/assets/img_228-BwJlS5DQ.png" alt="img_228.png" loading="lazy"></p><p>图中所涉及到的概念如下所述：</p><ul><li><p><strong>Name Server</strong>：是一个几乎无状态节点，可集群部署，在消息队列RocketMQ版中提供命名服务，更新和发现Broker服务。</p></li><li><p><strong>Broker</strong>：消息中转角色，负责存储消息，转发消息。分为Master Broker和Slave Broker，一个Master Broker可以对应多个Slave Broker，但是一个Slave Broker只能对应一个Master Broker。Broker启动后需要完成一次将自己注册至Name Server的操作；随后每隔30s定期向Name Server上报Topic路由信息。</p></li><li><p><strong>生产者</strong>：与Name Server集群中的其中一个节点（随机）建立长链接（Keep-alive），定期从Name Server读取Topic路由信息，并向提供Topic服务的Master Broker建立长链接，且定时向Master Broker发送心跳。</p></li><li><p><strong>消费者</strong>：与Name Server集群中的其中一个节点（随机）建立长连接，定期从Name Server拉取Topic路由信息，并向提供Topic服务的Master Broker、Slave Broker建立长连接，且定时向Master Broker、Slave Broker发送心跳。Consumer既可以从Master Broker订阅消息，也可以从Slave Broker订阅消息，订阅规则由Broker配置决定。</p></li></ul></div><!--[--><div style="text-align:center;"><h4><div class="social-share"><ul class="social-share-list" role="listbox"><li class="social-share-network" role="option"><button class="social-share-btn" title="qrcode" type="button" role="button" data-link><span class="social-share-icon-svg" focusable="false" style=""><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M352 608c38.4 0 64 25.6 64 64v128c0 38.4-25.6 64-64 64h-128c-38.4 0-64-25.6-64-64v-128c0-38.4 25.6-64 64-64h128m0-64h-128c-70.4 0-128 57.6-128 128v128c0 70.4 57.6 128 128 128h128c70.4 0 128-57.6 128-128v-128c0-70.4-57.6-128-128-128z"></path><path d="M320 800H256c-19.2 0-32-12.8-32-32v-64c0-19.2 12.8-32 32-32h64c19.2 0 32 12.8 32 32v64c0 19.2-12.8 32-32 32zM352 160c38.4 0 64 25.6 64 64v128c0 38.4-25.6 64-64 64h-128c-38.4 0-64-25.6-64-64v-128c0-38.4 25.6-64 64-64h128m0-64h-128c-70.4 0-128 57.6-128 128v128c0 70.4 57.6 128 128 128h128c70.4 0 128-57.6 128-128v-128c0-70.4-57.6-128-128-128z"></path><path d="M320 352H256c-19.2 0-32-12.8-32-32V256c0-19.2 12.8-32 32-32h64c19.2 0 32 12.8 32 32v64c0 19.2-12.8 32-32 32zM800 160c38.4 0 64 25.6 64 64v128c0 38.4-25.6 64-64 64h-128c-38.4 0-64-25.6-64-64v-128c0-38.4 25.6-64 64-64h128m0-64h-128c-70.4 0-128 57.6-128 128v128c0 70.4 57.6 128 128 128h128c70.4 0 128-57.6 128-128v-128c0-70.4-57.6-128-128-128z"></path><path d="M768 352h-64c-19.2 0-32-12.8-32-32V256c0-19.2 12.8-32 32-32h64c19.2 0 32 12.8 32 32v64c0 19.2-12.8 32-32 32z"></path><path d="M608 608m-32 0a32 32 0 1 0 64 0 32 32 0 1 0-64 0Z"></path><path d="M608 864m-32 0a32 32 0 1 0 64 0 32 32 0 1 0-64 0Z"></path><path d="M576 608h64v256H576z"></path><path d="M864 608m-32 0a32 32 0 1 0 64 0 32 32 0 1 0-64 0Z"></path><path d="M864 864m-32 0a32 32 0 1 0 64 0 32 32 0 1 0-64 0Z"></path><path d="M832 608h64v256h-64z"></path><path d="M736 608m-32 0a32 32 0 1 0 64 0 32 32 0 1 0-64 0Z"></path><path d="M736 864m-32 0a32 32 0 1 0 64 0 32 32 0 1 0-64 0Z"></path><path d="M704 608h64v256h-64z"></path></svg></span></button></li><li class="social-share-network" role="option"><button class="social-share-btn" title="wechat" type="button" role="button" data-link><span class="social-share-icon-svg" focusable="false" style=""><svg viewBox="0 0 1170 1024" xmlns="http://www.w3.org/2000/svg"><path d="M331.429 263.429q0-23.429-14.286-37.715t-37.714-14.285q-24.572 0-43.429 14.571t-18.857 37.429q0 22.285 18.857 36.857t43.429 14.571q23.428 0 37.714-14t14.286-37.428zM756 553.143q0-16-14.571-28.572T704 512q-15.429 0-28.286 12.857t-12.857 28.286q0 16 12.857 28.857T704 594.857q22.857 0 37.429-12.571T756 553.143zM621.143 263.429q0-23.429-14-37.715t-37.429-14.285q-24.571 0-43.428 14.571t-18.857 37.429q0 22.285 18.857 36.857t43.428 14.571q23.429 0 37.429-14t14-37.428zM984 553.143q0-16-14.857-28.572T932 512q-15.429 0-28.286 12.857t-12.857 28.286q0 16 12.857 28.857T932 594.857q22.286 0 37.143-12.571T984 553.143zM832 326.286Q814.286 324 792 324q-96.571 0-177.714 44T486.57 487.143 440 651.429q0 44.571 13.143 86.857-20 1.714-38.857 1.714-14.857 0-28.572-0.857t-31.428-3.714-25.429-4-31.143-6-28.571-6L124.57 792l41.143-124.571Q0 551.429 0 387.429q0-96.572 55.714-177.715T206.571 82t207.715-46.571q100.571 0 190 37.714T754 177.429t78 148.857z m338.286 320.571q0 66.857-39.143 127.714t-106 110.572l31.428 103.428-113.714-62.285q-85.714 21.143-124.571 21.143-96.572 0-177.715-40.286T512.857 797.714t-46.571-150.857T512.857 496t127.714-109.429 177.715-40.285q92 0 173.143 40.285t130 109.715 48.857 150.571z"></path></svg></span></button></li><li class="social-share-network" role="option"><button class="social-share-btn" title="qq" type="button" role="button" data-link="#share-qq"><span class="social-share-icon-svg" focusable="false" style=""><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M927.742 687.747c-6.87-94.604-70.349-173.86-107.044-214.854 5.094-11.926 17.49-80.957-30.374-128.058.077-1.13.077-2.25.077-3.347 0-185.805-132.253-319.547-298.196-320.155-165.971.61-298.218 134.35-298.218 320.155 0 1.097-.015 2.217.064 3.347-47.864 47.101-35.445 116.132-30.375 128.058-36.67 40.993-100.157 120.25-107.041 214.854-1.24 24.868 2.605 61.095 14.754 77.194 14.802 19.634 55.433-3.94 84.49-66.667 8.084 29.06 26.743 73.421 68.966 129.728-70.66 16.126-90.814 85.817-67.044 123.912 16.765 26.845 55.149 48.924 121.298 48.924 117.69 0 169.667-31.63 192.863-53.657 4.726-4.804 11.547-7.12 20.243-7.139 8.668.018 15.503 2.335 20.215 7.14 23.198 22.025 75.184 53.656 192.848 53.656 66.172 0 104.53-22.08 121.295-48.924 23.778-38.093 3.627-107.787-67.013-123.912 42.222-56.309 60.884-100.669 68.965-129.729 29.064 62.726 69.687 86.3 84.504 66.667 12.136-16.1 15.986-52.326 14.723-77.194"/></svg></span></button></li><li class="social-share-network" role="option"><button class="social-share-btn" title="weibo" type="button" role="button" data-link="#share-weibo"><span class="social-share-icon-svg" focusable="false" style=""><svg viewBox="0 0 1025 1024" xmlns="http://www.w3.org/2000/svg"><path d="M393.607 719.857q11.25-18.214 5.893-36.964t-24.107-26.786q-18.215-7.5-39.108-.535t-32.142 24.643q-11.786 18.213-6.965 36.695t23.037 27.055 39.91 1.338 33.482-25.446zm50.358-64.822q4.285-6.963 1.875-14.195t-9.375-9.912q-7.5-2.678-15.268 2.679t-11.519 9.911q-9.106 16.607 6.965 24.107 7.5 2.678 15.535 2.678t11.787-9.91zm93.213 57.322Q513.072 767 452.535 792.716t-120 6.428q-57.32-18.216-79.017-67.769T257 630.928q25.178-49.821 81.16-74.463t112.768-10.18q59.465 15.537 84.912 64.018t1.338 102.054zm167.144-85.714q-4.822-51.428-47.679-91.071t-111.696-58.394-147.054-11.25q-119.465 12.322-197.946 75.804t-70.982 141.696q4.82 51.429 47.678 91.072t111.697 58.393 147.053 11.25q119.464-12.321 197.947-75.803t70.982-141.697zm165 2.142q0 36.43-19.822 74.733t-58.393 73.392-90.267 62.947-121.072 44.465-144.911 16.606-147.322-17.946-128.838-49.822-91.875-80.892T32 645.393q0-61.608 37.232-131.25t105.803-138.215q90.537-90.535 182.947-126.428t132.053 3.75q34.822 34.285 10.715 111.965-2.143 7.5-.535 10.713t5.357 3.75 7.768 2.679 7.232-1.875l3.213-1.072q74.465-31.607 131.787-31.607t81.963 32.679q24.108 33.75 0 95.358-1.07 6.963-2.41 10.713t2.41 6.697 6.43 4.018 9.107 3.214q30.535 9.643 55.178 25.178t42.857 43.662 18.215 62.41zM829.678 294.5q22.5 25.178 29.197 58.125t-3.482 62.947q-4.286 12.321-15.803 18.213t-23.84 2.143q-12.322-4.285-18.215-15.803t-2.142-23.84q10.714-33.75-12.858-59.463t-57.32-18.75q-12.858 2.678-24.108-4.287t-13.391-19.82q-2.682-12.858 4.284-23.84t19.822-13.66q32.143-6.965 63.75 2.945t54.106 35.09zm96.965-87.322q46.607 51.429 60.266 119.197t-7.232 129.375q-4.821 14.465-18.213 21.428t-27.858 2.144-21.429-18.215-2.677-27.857q15-43.928 5.357-92.143T872 256.466q-33.215-36.966-79.285-51.163t-92.68-4.553q-15 3.215-27.858-5.09t-16.071-23.303 5.09-27.589 23.304-15.803q65.893-13.93 130.715 6.16t111.428 72.053z"/></svg></span></button></li></ul></div></h4><h4>公众号更有货，推荐关注！</h4><img src="https://ujava.cn/logo/gzh-wz.png"></div><!--]--><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><!----><!----></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/assembly/redis.html" aria-label="组件Redis"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>组件Redis</div></a><a class="route-link auto-link next" href="/assembly/serverless.html" aria-label="组件Serverless"><div class="hint">下一页<span class="arrow end"></span></div><div class="link">组件Serverless<span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span></div></a></nav><!----><!----><!--]--></main><!--]--><!--]--><footer class="vp-footer-wrapper" vp-footer><!----><div class="vp-copyright">Copyright © 2024 UJava </div></footer></div><!--]--><!--]--><!--[--><!----><div class="social-share-global"><!----><button class="social-share-btn social-share-trigger" type="button" role="button"><span class="social-share-icon-svg"><svg viewBox="0 0 1040 1024" xmlns="http://www.w3.org/2000/svg">
  <path d="M823.506 631.474c0-7.192-3.783-12.397-11.352-15.71-6.816-2.838-13.154-1.419-18.925 4.352-9.37 8.612-19.116 15.33-29.24 19.968-6.529 3.594-9.745 8.801-9.745 15.71V771.53c0 23.753-8.516 44.195-25.455 61.132-16.938 16.936-37.283 25.455-61.132 25.455H217.765c-23.753 0-44.195-8.517-61.131-25.455-16.937-16.939-25.455-37.284-25.455-61.132V321.639c0-23.753 8.516-44.195 25.455-61.132s37.283-25.455 61.131-25.455h60.565c2.175 0 5.016-.757 8.612-2.174 20.156-12.304 44.195-23.091 71.921-32.459 9.37-1.799 14.1-7.57 14.1-17.317 0-4.734-1.703-8.708-5.108-12.208-3.407-3.407-7.476-5.108-12.208-5.108h-137.88c-42.87 0-79.588 15.235-110.06 45.707S62 278.683 62 321.553V771.54c0 42.87 15.234 79.588 45.707 110.06s67.19 45.707 110.06 45.707H667.66c42.87 0 79.589-15.234 110.06-45.707 30.472-30.473 45.708-67.19 45.708-110.06l.095-140.06-.016-.006zm138.454-292.52c0-9.369-3.408-17.506-10.315-24.32L744.016 107.005c-6.815-6.815-14.953-10.315-24.32-10.315-4.353 0-8.802.945-13.535 2.745-14.1 6.15-21.106 16.75-21.106 31.891v103.812h-86.497c-38.235 0-73.625 1.986-106.273 5.962-32.648 3.976-61.42 9.465-86.215 16.468-24.887 7.004-47.315 15.805-67.282 26.214-19.967 10.41-37 21.576-51.104 33.217-14.103 11.64-26.403 25.077-37 40.03-10.598 14.953-19.117 29.62-25.456 44.097-6.34 14.387-11.352 30.285-15.142 47.604-3.783 17.317-6.341 33.5-7.571 48.64-1.229 15.143-1.893 31.514-1.893 49.212 0 20.157 3.125 42.208 9.465 65.959 6.34 23.753 13.25 44.384 20.818 61.608 7.571 17.317 16.468 35.207 26.784 53.848 10.315 18.55 17.413 30.945 21.387 37.001 3.977 6.15 7.76 11.736 11.353 16.75 3.595 4.733 8.327 7.004 14.1 7.004 1.42 0 3.595-.381 6.529-1.042 8.327-3.977 11.925-10.126 10.787-18.358-16.184-121.134-2.838-206.4 40.03-255.797 41.452-47.222 120.376-70.88 236.868-70.88h86.497v103.81c0 15.143 7.004 25.742 21.106 31.892 4.734 1.799 9.18 2.745 13.534 2.745 9.745 0 17.887-3.408 24.321-10.316L951.83 363.178c6.716-6.815 10.126-14.858 10.126-24.227l.004.004z" />
</svg></span></button></div><!--]--><!--]--></div>
    <script type="module" src="/assets/app-CZKXz-g7.js" defer></script>
  </body>
</html>
